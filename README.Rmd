---
title: "The Metropolitan Transportation Authority of New York City"
author: Anthony Josue Roman
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
library(mosaic)
library(mosaicData)
library(dplyr)
library(ggplot2)
library(gtfsr)
library(magrittr)
library(dplyr)
require(mosaicData)
require(mosaic)
require(ggplot2)
require(gtfsr)
require(magrittr)
require(dplyr)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments()
```

I will begin analysing the data provided from New York City's transportation authority, also known as the MTA. The following data used will include success and failure rates for each department.  
In order to use this data, I had to apply through its website in order to obtain this data. The given data will be provided along with this file, and in the website. In order to make this data easier to read, there were csv files created in order to yield a viable graph and for data wrangling purposes.

New York City is one of the most populated cities in the world, and has one of the largest public transportation systems in the world as well.

Below is a comparison between the Completed and projected Trips from MTA Bus and MTA New York City Bus. Note: On 2012, Hurricane Sandy did affect service, along with other years due to suspension of service.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
bustripdata <- read.csv("bustrip.csv")
bustripdata %>% 
  ggplot(aes(x=PERIOD_YEAR,y=count,color=type)) +
  stat_smooth() +
  geom_point() + 
  xlab("Year") + 
  ylab("% of Completed Trips") +
  ggtitle("Complteted trips for the New York City Bus")
```
  
Below is the data used for the graph above, which explains the completed trip percentage per year. The type shows the difference between the actual and target (predicted) data gathered for NYCT Bus.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
bustripdata <- read.csv("bustrip.csv")
knitr::kable(bustripdata)
```

This is the Metro North Railroad with multiple indicator types, and I will focus on the MNRR Hudson Harlem and Port Jervis Lines.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
mnrr <- read.csv("MTA_Performance_MNR.csv")
mnrr <- 
  mnrr %>% 
  select(INDICATOR_NAME,PERIOD_YEAR,YTD_TARGET,YTD_ACTUAL)
mnrr1 <-
  mnrr %>%
  group_by(INDICATOR_NAME,PERIOD_YEAR) %>%
  summarise(avgtarget=mean(YTD_TARGET),avgactual=mean(YTD_ACTUAL))
knitr::kable(mnrr1)
```

Below is the Metro North Hudson line, where we will analyse the data on the percentage that the trains arrive on time.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
hudson <- read.csv("mnrrh.csv")
knitr::kable(hudson)
```

Below is the data used for the graph above, which explains the percentage that the trains arrive on time per year. The type shows the difference between the actual and target (predicted) data gathered for the MNRR Hudson Line.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
mnrrh <- read.csv("mnrrh.csv")
mnrrh %>% 
  ggplot(aes(x=PERIOD_YEAR,y=count,color=type)) +
  stat_smooth() +
  geom_point() + 
  xlab("Year") + 
  ylab("% of on time arrivals") +
  ggtitle("Arrival Times for the Hudson Line")
```

Below is the Port Jervis line, where we will analyse the data on the percentage that the trains arrive on time along with its graph

```{r, echo=FALSE, message=FALSE}
mnrr <- read.csv("mnrr.csv")
pjl <-
  mnrr %>%
  filter(INDICATOR_SEQ==28460)
pjl <-
  pjl %>%
  select(INDICATOR_NAME,PERIOD_YEAR,count,type)
knitr::kable(pjl)
```

```{r, echo=FALSE, message=FALSE}
mnrr <- read.csv("mnrr.csv")
pjl <-
  mnrr %>%
  filter(INDICATOR_SEQ==28460)
pjl <-
  pjl %>%
  select(INDICATOR_NAME,PERIOD_YEAR,count,type)
pjl %>% 
  ggplot(aes(x=PERIOD_YEAR,y=count,color=type)) +
  stat_smooth() +
  geom_point() + 
  xlab("Year") + 
  ylab("% of on time arrivals") +
  ggtitle("Arrival Times for the Port Jervis Line")
```

Below shows the comparisons between all the MNRR trunk line actual and target arrival times, with each indicator name being the name of the MNRR trunk line.

```{r, echo=FALSE, message=FALSE}
mnrr <- read.csv("mnrr.csv")
mnrr1 <- 
  mnrr %>% 
  filter(INDICATOR_SEQ %in% c(28346,28345,28347,28461,28460))
mnrra <-
  mnrr1 %>%
  filter(type == "actual")
mnrra %>% 
  ggplot(aes(x=PERIOD_YEAR,y=count,color=INDICATOR_NAME)) +
  stat_smooth() +
  geom_point() + 
  xlab("Year") + 
  ylab("% of on time arrivals") +
  ggtitle("Actual Arrival Times for Each Trunk Line")
```

```{r, echo=FALSE, message=FALSE}
mnrr <- read.csv("mnrr.csv")
mnrr1 <- 
  mnrr %>% 
  filter(INDICATOR_SEQ %in% c(28346,28345,28347,28461,28460))
mnrrt <-
  mnrr1 %>%
  filter(type == "target")
mnrrt %>% 
  ggplot(aes(x=PERIOD_YEAR,y=count,color=INDICATOR_NAME)) +
  stat_smooth() +
  geom_point() + 
  xlab("Year") + 
  ylab("% of on time arrivals") +
  ggtitle("Target Arrival Times for Each Trunk Line")
```